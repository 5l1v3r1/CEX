#include "FFTM12T62.h"
#include "IAeadMode.h"
#include "IDigest.h"
#include "IntUtils.h"
#include "McElieceUtils.h"
#include "MemUtils.h"
#include "SymmetricKey.h"

NAMESPACE_MCELIECE

using Cipher::Symmetric::Block::Mode::IAeadMode;
using Digest::IDigest;
using Utility::IntUtils;
using Utility::MemUtils;

const std::array<std::array<ulong, 12>, 63> FFTM12T62::ButterflyConsts =
{ 
	{
		{
			0xF00F0FF0F00F0FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0x0FF00FF00FF00FF0ULL, 0xAA5555AAAA5555AAULL,
			0xF00F0FF0F00F0FF0ULL, 0x33CCCC33CC3333CCULL, 0xFFFF0000FFFF0000ULL, 0xCC33CC3333CC33CCULL,
			0x33CC33CC33CC33CCULL, 0x5A5A5A5A5A5A5A5AULL, 0xFF00FF00FF00FF00ULL, 0xF00F0FF0F00F0FF0ULL,
		},
		{
			0x3C3C3C3C3C3C3C3CULL, 0xF0F0F0F0F0F0F0F0ULL, 0x5555AAAA5555AAAAULL, 0xCC3333CCCC3333CCULL,
			0xC33CC33CC33CC33CULL, 0x55555555AAAAAAAAULL, 0x33333333CCCCCCCCULL, 0x00FF00FFFF00FF00ULL,
			0xF0F0F0F0F0F0F0F0ULL, 0x0000000000000000ULL, 0x0000FFFFFFFF0000ULL, 0xF0F00F0F0F0FF0F0ULL,
		},
		{
			0x3C3C3C3C3C3C3C3CULL, 0x0F0F0F0F0F0F0F0FULL, 0xAAAA5555AAAA5555ULL, 0xCC3333CCCC3333CCULL,
			0xC33CC33CC33CC33CULL, 0x55555555AAAAAAAAULL, 0x33333333CCCCCCCCULL, 0xFF00FF0000FF00FFULL,
			0x0F0F0F0F0F0F0F0FULL, 0x0000000000000000ULL, 0x0000FFFFFFFF0000ULL, 0xF0F00F0F0F0FF0F0ULL,
		},
		{
			0xAA55AA5555AA55AAULL, 0xCC33CC3333CC33CCULL, 0x33CCCC33CC3333CCULL, 0x55555555AAAAAAAAULL,
			0xFF0000FF00FFFF00ULL, 0x3CC33CC3C33CC33CULL, 0x5555AAAA5555AAAAULL, 0x0FF00FF00FF00FF0ULL,
			0xCCCC33333333CCCCULL, 0xF0F0F0F0F0F0F0F0ULL, 0x00FFFF0000FFFF00ULL, 0xC33CC33CC33CC33CULL,
		},
		{
			0x55AA55AAAA55AA55ULL, 0xCC33CC3333CC33CCULL, 0xCC3333CC33CCCC33ULL, 0x55555555AAAAAAAAULL,
			0xFF0000FF00FFFF00ULL, 0xC33CC33C3CC33CC3ULL, 0xAAAA5555AAAA5555ULL, 0xF00FF00FF00FF00FULL,
			0x3333CCCCCCCC3333ULL, 0x0F0F0F0F0F0F0F0FULL, 0xFF0000FFFF0000FFULL, 0xC33CC33CC33CC33CULL,
		},
		{
			0xAA55AA5555AA55AAULL, 0x33CC33CCCC33CC33ULL, 0xCC3333CC33CCCC33ULL, 0x55555555AAAAAAAAULL,
			0x00FFFF00FF0000FFULL, 0x3CC33CC3C33CC33CULL, 0x5555AAAA5555AAAAULL, 0x0FF00FF00FF00FF0ULL,
			0x3333CCCCCCCC3333ULL, 0xF0F0F0F0F0F0F0F0ULL, 0x00FFFF0000FFFF00ULL, 0xC33CC33CC33CC33CULL,
		},
		{
			0x55AA55AAAA55AA55ULL, 0x33CC33CCCC33CC33ULL, 0x33CCCC33CC3333CCULL, 0x55555555AAAAAAAAULL,
			0x00FFFF00FF0000FFULL, 0xC33CC33C3CC33CC3ULL, 0xAAAA5555AAAA5555ULL, 0xF00FF00FF00FF00FULL,
			0xCCCC33333333CCCCULL, 0x0F0F0F0F0F0F0F0FULL, 0xFF0000FFFF0000FFULL, 0xC33CC33CC33CC33CULL,
		},
		{
			0x6699669999669966ULL, 0x33CCCC33CC3333CCULL, 0xA5A5A5A55A5A5A5AULL, 0x3C3CC3C3C3C33C3CULL,
			0xF00FF00F0FF00FF0ULL, 0x55AA55AA55AA55AAULL, 0x3C3CC3C3C3C33C3CULL, 0x0F0F0F0FF0F0F0F0ULL,
			0x55AA55AA55AA55AAULL, 0x33CCCC33CC3333CCULL, 0xF0F0F0F0F0F0F0F0ULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x9966996666996699ULL, 0x33CCCC33CC3333CCULL, 0xA5A5A5A55A5A5A5AULL, 0x3C3CC3C3C3C33C3CULL,
			0x0FF00FF0F00FF00FULL, 0xAA55AA55AA55AA55ULL, 0x3C3CC3C3C3C33C3CULL, 0xF0F0F0F00F0F0F0FULL,
			0xAA55AA55AA55AA55ULL, 0xCC3333CC33CCCC33ULL, 0x0F0F0F0F0F0F0F0FULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x6699669999669966ULL, 0x33CCCC33CC3333CCULL, 0x5A5A5A5AA5A5A5A5ULL, 0xC3C33C3C3C3CC3C3ULL,
			0x0FF00FF0F00FF00FULL, 0xAA55AA55AA55AA55ULL, 0xC3C33C3C3C3CC3C3ULL, 0x0F0F0F0FF0F0F0F0ULL,
			0xAA55AA55AA55AA55ULL, 0x33CCCC33CC3333CCULL, 0xF0F0F0F0F0F0F0F0ULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x9966996666996699ULL, 0x33CCCC33CC3333CCULL, 0x5A5A5A5AA5A5A5A5ULL, 0xC3C33C3C3C3CC3C3ULL,
			0xF00FF00F0FF00FF0ULL, 0x55AA55AA55AA55AAULL, 0xC3C33C3C3C3CC3C3ULL, 0xF0F0F0F00F0F0F0FULL,
			0x55AA55AA55AA55AAULL, 0xCC3333CC33CCCC33ULL, 0x0F0F0F0F0F0F0F0FULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x6699669999669966ULL, 0xCC3333CC33CCCC33ULL, 0x5A5A5A5AA5A5A5A5ULL, 0x3C3CC3C3C3C33C3CULL,
			0x0FF00FF0F00FF00FULL, 0x55AA55AA55AA55AAULL, 0x3C3CC3C3C3C33C3CULL, 0x0F0F0F0FF0F0F0F0ULL,
			0x55AA55AA55AA55AAULL, 0x33CCCC33CC3333CCULL, 0xF0F0F0F0F0F0F0F0ULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x9966996666996699ULL, 0xCC3333CC33CCCC33ULL, 0x5A5A5A5AA5A5A5A5ULL, 0x3C3CC3C3C3C33C3CULL,
			0xF00FF00F0FF00FF0ULL, 0xAA55AA55AA55AA55ULL, 0x3C3CC3C3C3C33C3CULL, 0xF0F0F0F00F0F0F0FULL,
			0xAA55AA55AA55AA55ULL, 0xCC3333CC33CCCC33ULL, 0x0F0F0F0F0F0F0F0FULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x6699669999669966ULL, 0xCC3333CC33CCCC33ULL, 0xA5A5A5A55A5A5A5AULL, 0xC3C33C3C3C3CC3C3ULL,
			0xF00FF00F0FF00FF0ULL, 0xAA55AA55AA55AA55ULL, 0xC3C33C3C3C3CC3C3ULL, 0x0F0F0F0FF0F0F0F0ULL,
			0xAA55AA55AA55AA55ULL, 0x33CCCC33CC3333CCULL, 0xF0F0F0F0F0F0F0F0ULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x9966996666996699ULL, 0xCC3333CC33CCCC33ULL, 0xA5A5A5A55A5A5A5AULL, 0xC3C33C3C3C3CC3C3ULL,
			0x0FF00FF0F00FF00FULL, 0x55AA55AA55AA55AAULL, 0xC3C33C3C3C3CC3C3ULL, 0xF0F0F0F00F0F0F0FULL,
			0x55AA55AA55AA55AAULL, 0xCC3333CC33CCCC33ULL, 0x0F0F0F0F0F0F0F0FULL, 0xA55A5AA55AA5A55AULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x6996699669966996ULL, 0x00FFFF0000FFFF00ULL,
			0xFF00FF00FF00FF00ULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x6996699669966996ULL, 0x00FFFF0000FFFF00ULL,
			0x00FF00FF00FF00FFULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x6996699669966996ULL, 0xFF0000FFFF0000FFULL,
			0x00FF00FF00FF00FFULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x6996699669966996ULL, 0xFF0000FFFF0000FFULL,
			0xFF00FF00FF00FF00ULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x9669966996699669ULL, 0xFF0000FFFF0000FFULL,
			0x00FF00FF00FF00FFULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x9669966996699669ULL, 0xFF0000FFFF0000FFULL,
			0xFF00FF00FF00FF00ULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x9669966996699669ULL, 0x00FFFF0000FFFF00ULL,
			0xFF00FF00FF00FF00ULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x6996699669966996ULL, 0x9669966996699669ULL, 0x00FFFF0000FFFF00ULL,
			0x00FF00FF00FF00FFULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x9669966996699669ULL, 0x00FFFF0000FFFF00ULL,
			0xFF00FF00FF00FF00ULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x9669966996699669ULL, 0x00FFFF0000FFFF00ULL,
			0x00FF00FF00FF00FFULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x9669966996699669ULL, 0xFF0000FFFF0000FFULL,
			0x00FF00FF00FF00FFULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x9669966996699669ULL, 0xFF0000FFFF0000FFULL,
			0xFF00FF00FF00FF00ULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x6996699669966996ULL, 0xFF0000FFFF0000FFULL,
			0x00FF00FF00FF00FFULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x6996699669966996ULL, 0xFF0000FFFF0000FFULL,
			0xFF00FF00FF00FF00ULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x6996699669966996ULL, 0x00FFFF0000FFFF00ULL,
			0xFF00FF00FF00FF00ULL, 0x0FF00FF0F00FF00FULL, 0x0F0FF0F0F0F00F0FULL, 0xC33C3CC33CC3C33CULL,
			0xC33C3CC33CC3C33CULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x9669699696696996ULL, 0x9669966996699669ULL, 0x6996699669966996ULL, 0x00FFFF0000FFFF00ULL,
			0x00FF00FF00FF00FFULL, 0xF00FF00F0FF00FF0ULL, 0xF0F00F0F0F0FF0F0ULL, 0x3CC3C33CC33C3CC3ULL,
			0x3CC3C33CC33C3CC3ULL, 0xA55A5AA55AA5A55AULL, 0xC33C3CC33CC3C33CULL, 0x3CC3C33C3CC3C33CULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		}
	}
};

const std::array<std::array<ulong, 12>, 64> FFTM12T62::GfPoints =
{
	{
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		},
		{
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL,
			0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFF0000FFFF0000ULL,
			0xFF00FF00FF00FF00ULL, 0xF0F0F0F0F0F0F0F0ULL, 0xCCCCCCCCCCCCCCCCULL, 0xAAAAAAAAAAAAAAAAULL,
		}
	}
};

const std::array<std::array<std::array<ulong, 12>, 2>, 5> FFTM12T62::RadixTrScalar =
{
	{
		{
			{
				{
					0xF3CFC030FC30F003ULL, 0x3FCF0F003C00C00CULL, 0x30033CC300C0C03CULL, 0xCCFF0F3C0F30F0C0ULL,
					0x0300C03FF303C3F0ULL, 0x3FFF3C0FF0CCCCC0ULL, 0xF3FFF0C00F3C3CC0ULL, 0x3003333FFFC3C000ULL,
					0x0FF30FFFC3FFF300ULL, 0xFFC0F300F0F0CC00ULL, 0xC0CFF3FCCC3CFC00ULL, 0xFC3C03F0F330C000ULL,
				},
				{
					0x000C03C0C3C0330CULL, 0xF330CFFCC00F33C0ULL, 0xCCF330F00F3C0333ULL, 0xFF03FFF3FF0CF0C0ULL,
					0x3CC3FCF00FCC303CULL, 0x0F000C0FC30303F3ULL, 0xCF0FC3FF333CCF3CULL, 0x003F3FC3C0FF333FULL,
					0x3CC3F0F3CF0FF00FULL, 0xF3F33CC03FC30CC0ULL, 0x3CC330CFC333F33FULL, 0x3CC0303FF3C3FFFCULL,
				}
			}
		},
		{
			{
				{
					0x000F00000000F00FULL, 0x00000F00F00000F0ULL, 0x0F00000F00000F00ULL, 0xF00F00F00F000000ULL,
					0x00F00000000000F0ULL, 0x0000000F00000000ULL, 0xF00000000F00F000ULL, 0x00F00F00000F0000ULL,
					0x0000F00000F00F00ULL, 0x000F00F00F00F000ULL, 0x00F00F0000000000ULL, 0x0000000000F00000ULL,
				},
				{
					0x0F00F00F00000000ULL, 0xF00000000000F000ULL, 0x00000F00000000F0ULL, 0x0F00F00000F00000ULL,
					0x000F00000F00F00FULL, 0x00F00F00F00F0000ULL, 0x0F00F00000000000ULL, 0x000000000F000000ULL,
					0x00F00000000F00F0ULL, 0x0000F00F00000F00ULL, 0xF00000F00000F00FULL, 0x00000F00F00F00F0ULL,
				}
			}
		},
		{
			{
				{
					0x0000FF00FF0000FFULL, 0x0000FF000000FF00ULL, 0xFF0000FF00FF0000ULL, 0xFFFF0000FF000000ULL,
					0x00FF00FF00FF0000ULL, 0x0000FFFFFF000000ULL, 0x00FFFF00FF000000ULL, 0xFFFFFF0000FF0000ULL,
					0xFFFF00FFFF00FF00ULL, 0x0000FF0000000000ULL, 0xFFFFFF00FF000000ULL, 0x00FF000000000000ULL,
				},
				{
					0xFF00FFFFFF000000ULL, 0xFF0000FFFF000000ULL, 0xFFFF00FFFF000000ULL, 0xFF00FFFFFFFFFF00ULL,
					0x00000000FF00FF00ULL, 0xFFFFFFFF00FF0000ULL, 0x00FFFFFF00FF0000ULL, 0xFFFF00FFFF00FFFFULL,
					0xFFFF0000FFFFFFFFULL, 0xFF00000000FF0000ULL, 0x000000FF00FF00FFULL, 0x00FF00FF00FFFF00ULL,
				}
			}
		},
		{
			{
				{
					0x000000000000FFFFULL, 0x00000000FFFF0000ULL, 0x0000000000000000ULL, 0xFFFF000000000000ULL,
					0x00000000FFFF0000ULL, 0x0000FFFF00000000ULL, 0x0000000000000000ULL, 0x00000000FFFF0000ULL,
					0x0000FFFF00000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
				},
				{
					0x0000000000000000ULL, 0xFFFF000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
					0xFFFF00000000FFFFULL, 0x0000000000000000ULL, 0x0000FFFF00000000ULL, 0xFFFF00000000FFFFULL,
					0x00000000FFFF0000ULL, 0x0000000000000000ULL, 0xFFFF00000000FFFFULL, 0x00000000FFFF0000ULL,
				}
			}
		},
		{
			{
				{
					0x00000000FFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFFFFFF00000000ULL, 0x0000000000000000ULL,
					0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
					0xFFFFFFFF00000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
				},
				{
					0x0000000000000000ULL, 0x0000000000000000ULL, 0x00000000FFFFFFFFULL, 0xFFFFFFFF00000000ULL,
					0xFFFFFFFF00000000ULL, 0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0xFFFFFFFFFFFFFFFFULL,
					0xFFFFFFFF00000000ULL, 0x0000000000000000ULL, 0xFFFFFFFFFFFFFFFFULL, 0xFFFFFFFF00000000ULL,
				}
			}
		}
	}
};

//~~~Public Functions~~~//

bool FFTM12T62::Decrypt(std::vector<byte> &E, const std::vector<byte> &PrivateKey, const std::vector<byte> &S)
{
	size_t i;
	ulong diff;
	ulong t;

	std::array<ulong, CND_SIZE / 8> cond;

	IntUtils::BlockToLe(PrivateKey, IRR_SIZE, cond, 0, CND_SIZE);
	std::vector<ulong> recv(64);
	PreProcess(recv, S);
	McElieceUtils::BenesCompact(recv, cond, 1);

	// scaling
	std::array<std::array<ulong, M>, 64> inverse;
	std::array<std::array<ulong, M>, 64> scaled;
	Scaling(scaled, inverse, PrivateKey, recv);

	// transposed FFT
	std::array<std::array<ulong, M>, 2> sPriv;
	TransposedFFT::Transform(sPriv, scaled);
	SyndromeAdjust(sPriv);

	// Berlekamp Massey
	std::array<ulong, M> locator;
	std::memset(&locator[0], byte(0), locator.size() * sizeof(ulong));
	BerlekampMassey(locator, sPriv);

	// additive FFT
	std::array<std::array<ulong, M>, 64> eval;
	AdditiveFFT::Transform(eval, locator);

	std::array<ulong, 64> error;
	for (i = 0; i < 64; i++)
	{
		error[i] = McElieceUtils::Or(eval[i], M);
		error[i] = ~error[i];
	}

	// re-encrypt
	ScalingInverse(scaled, inverse, error);
	std::array<std::array<ulong, M>, 2> sPrivCmp;
	TransposedFFT::Transform(sPrivCmp, scaled);
	SyndromeAdjust(sPrivCmp);

	diff = 0;
	diff |= sPriv[0][0] ^ sPrivCmp[0][0];
	diff |= sPriv[0][1] ^ sPrivCmp[0][1];
	diff |= sPriv[0][2] ^ sPrivCmp[0][2];
	diff |= sPriv[0][3] ^ sPrivCmp[0][3];
	diff |= sPriv[0][4] ^ sPrivCmp[0][4];
	diff |= sPriv[0][5] ^ sPrivCmp[0][5];
	diff |= sPriv[0][6] ^ sPrivCmp[0][6];
	diff |= sPriv[0][7] ^ sPrivCmp[0][7];
	diff |= sPriv[0][8] ^ sPrivCmp[0][8];
	diff |= sPriv[0][9] ^ sPrivCmp[0][9];
	diff |= sPriv[0][10] ^ sPrivCmp[0][10];
	diff |= sPriv[0][11] ^ sPrivCmp[0][11];
	diff |= sPriv[1][0] ^ sPrivCmp[1][0];
	diff |= sPriv[1][1] ^ sPrivCmp[1][1];
	diff |= sPriv[1][2] ^ sPrivCmp[1][2];
	diff |= sPriv[1][3] ^ sPrivCmp[1][3];
	diff |= sPriv[1][4] ^ sPrivCmp[1][4];
	diff |= sPriv[1][5] ^ sPrivCmp[1][5];
	diff |= sPriv[1][6] ^ sPrivCmp[1][6];
	diff |= sPriv[1][7] ^ sPrivCmp[1][7];
	diff |= sPriv[1][8] ^ sPrivCmp[1][8];
	diff |= sPriv[1][9] ^ sPrivCmp[1][9];
	diff |= sPriv[1][10] ^ sPrivCmp[1][10];
	diff |= sPriv[1][11] ^ sPrivCmp[1][11];
	diff |= diff >> 32;
	diff |= diff >> 16;
	diff |= diff >> 8;
	t = diff & 0xFF;

	// compact and store
	McElieceUtils::BenesCompact(error, cond, 0);
	IntUtils::LeToBlock(error, 0, E, 0, error.size() * sizeof(ulong));

	t |= McElieceUtils::Weight(error) ^ T;
	t -= 1;
	t >>= 63;

	return (t - 1 == 0) ? true : false;
}

void FFTM12T62::Encrypt(std::vector<byte> &S, std::vector<byte> &E, const std::vector<byte> &PublicKey, std::unique_ptr<IPrng> &Random)
{
	GenE(E, Random);
	Syndrome(S, PublicKey, E);
}

bool FFTM12T62::Generate(std::vector<byte> &PublicKey, std::vector<byte> &PrivateKey, std::unique_ptr<IPrng> &Random)
{
	size_t ctr;

	for (ctr = 0; ctr < GEN_MAXR; ++ctr)
	{
		SkGen(PrivateKey, Random);

		if (PkGen(PublicKey, PrivateKey)) 
		{
			break;
		}
	}

	return (ctr < GEN_MAXR) ? true : false;
}

//~~~Private Functions~~~//

//~~~Decrypt~~~//

void FFTM12T62::BerlekampMassey(std::array<ulong, M> &Output, std::array<std::array<ulong, M>, 2> &Input)
{
	ushort b;
	ushort bInv;
	ushort d;
	ushort L;
	ushort mask16b;
	ushort N;
	ushort r;
	ulong maskLeq;
	ulong maskNz;
	std::array<ulong, M> B;
	std::array<ulong, M> prod;
	std::array<ulong, M> tmpIn;
	std::array<ulong, M> rVec;
	std::array<ulong, M> tmpC;

	Output[0] = 1;
	MemUtils::Copy(Output, 0, B, 0, M * sizeof(ulong));
	Output[0] <<= 63;
	B[0] <<= 62;
	b = 1;
	L = 0;

	for (N = 0; N < T * 2; N++)
	{
		// computing d
		if (N < 64)
		{
			tmpIn[0] = Input[0][0] << (63 - N);
			tmpIn[1] = Input[0][1] << (63 - N);
			tmpIn[2] = Input[0][2] << (63 - N);
			tmpIn[3] = Input[0][3] << (63 - N);
			tmpIn[4] = Input[0][4] << (63 - N);
			tmpIn[5] = Input[0][5] << (63 - N);
			tmpIn[6] = Input[0][6] << (63 - N);
			tmpIn[7] = Input[0][7] << (63 - N);
			tmpIn[8] = Input[0][8] << (63 - N);
			tmpIn[9] = Input[0][9] << (63 - N);
			tmpIn[10] = Input[0][10] << (63 - N);
			tmpIn[11] = Input[0][11] << (63 - N);
		}
		else
		{
			tmpIn[0] = (Input[0][0] >> (N - 63)) | (Input[1][0] << (127 - N));
			tmpIn[1] = (Input[0][1] >> (N - 63)) | (Input[1][1] << (127 - N));
			tmpIn[2] = (Input[0][2] >> (N - 63)) | (Input[1][2] << (127 - N));
			tmpIn[3] = (Input[0][3] >> (N - 63)) | (Input[1][3] << (127 - N));
			tmpIn[4] = (Input[0][4] >> (N - 63)) | (Input[1][4] << (127 - N));
			tmpIn[5] = (Input[0][5] >> (N - 63)) | (Input[1][5] << (127 - N));
			tmpIn[6] = (Input[0][6] >> (N - 63)) | (Input[1][6] << (127 - N));
			tmpIn[7] = (Input[0][7] >> (N - 63)) | (Input[1][7] << (127 - N));
			tmpIn[8] = (Input[0][8] >> (N - 63)) | (Input[1][8] << (127 - N));
			tmpIn[9] = (Input[0][9] >> (N - 63)) | (Input[1][9] << (127 - N));
			tmpIn[10] = (Input[0][10] >> (N - 63)) | (Input[1][10] << (127 - N));
			tmpIn[11] = (Input[0][11] >> (N - 63)) | (Input[1][11] << (127 - N));
		}

		McElieceUtils::Multiply(prod, Output, tmpIn);
		d = McElieceUtils::Reduce(prod, M);

		// 3 cases
		bInv = McElieceUtils::Invert(b, M);
		r = McElieceUtils::Multiply(d, bInv, M);
		McElieceUtils::Insert(rVec, r);
		McElieceUtils::Multiply(tmpC, rVec, B);

		tmpC[0] ^= Output[0];
		tmpC[1] ^= Output[1];
		tmpC[2] ^= Output[2];
		tmpC[3] ^= Output[3];
		tmpC[4] ^= Output[4];
		tmpC[5] ^= Output[5];
		tmpC[6] ^= Output[6];
		tmpC[7] ^= Output[7];
		tmpC[8] ^= Output[8];
		tmpC[9] ^= Output[9];
		tmpC[10] ^= Output[10];
		tmpC[11] ^= Output[11];

		maskNz = McElieceUtils::MaskNonZero64(d);
		maskLeq = McElieceUtils::MaskLeq64(L * 2, N);
		mask16b = (maskNz & maskLeq) & 0xFFFF;

		McElieceUtils::CMov(Output, B, maskNz & maskLeq);
		McElieceUtils::Copy(tmpC, Output);

		b = (d & mask16b) | (b & ~mask16b);
		L = ((N + 1 - L) & mask16b) | (L & ~mask16b);

		B[0] >>= 1;
		B[1] >>= 1;
		B[2] >>= 1;
		B[3] >>= 1;
		B[4] >>= 1;
		B[5] >>= 1;
		B[6] >>= 1;
		B[7] >>= 1;
		B[8] >>= 1;
		B[9] >>= 1;
		B[10] >>= 1;
		B[11] >>= 1;
	}

	Output[0] >>= 64 - (T + 1);
	Output[1] >>= 64 - (T + 1);
	Output[2] >>= 64 - (T + 1);
	Output[3] >>= 64 - (T + 1);
	Output[4] >>= 64 - (T + 1);
	Output[5] >>= 64 - (T + 1);
	Output[6] >>= 64 - (T + 1);
	Output[7] >>= 64 - (T + 1);
	Output[8] >>= 64 - (T + 1);
	Output[9] >>= 64 - (T + 1);
	Output[10] >>= 64 - (T + 1);
	Output[11] >>= 64 - (T + 1);
}

void FFTM12T62::PreProcess(std::vector<ulong> &Received, const std::vector<byte> &S)
{
	IntUtils::BlockToLe(S, 0, Received, 0, SECRET_SIZE - 5);

	Received[SECRET_SIZE / 8] <<= 8;
	Received[SECRET_SIZE / 8] |= S[((SECRET_SIZE / 8) * 8) + 4];
	Received[SECRET_SIZE / 8] <<= 8;
	Received[SECRET_SIZE / 8] |= S[((SECRET_SIZE / 8) * 8) + 3];
	Received[SECRET_SIZE / 8] <<= 8;
	Received[SECRET_SIZE / 8] |= S[((SECRET_SIZE / 8) * 8) + 2];
	Received[SECRET_SIZE / 8] <<= 8;
	Received[SECRET_SIZE / 8] |= S[((SECRET_SIZE / 8) * 8) + 1];
	Received[SECRET_SIZE / 8] <<= 8;
	Received[SECRET_SIZE / 8] |= S[((SECRET_SIZE / 8) * 8)];
}

void FFTM12T62::Scaling(std::array<std::array<ulong, M>, 64> &Output, std::array<std::array<ulong, M>, 64> &Inverse, const std::vector<byte> &PrivateKey, std::vector<ulong> &Received)
{
	std::array<ulong, M> skInt;
	std::array<std::array<ulong, M>, 64> eval;
	std::array<ulong, M> tmp;
	size_t i;

	// computing inverses
	MemUtils::Copy(PrivateKey, 0, skInt, 0, M * sizeof(ulong));
	AdditiveFFT::Transform(eval, skInt);
	Square(eval[0], eval[0]);
	McElieceUtils::Copy(eval[0], Inverse[0]);

	for (i = 1; i < 64; i++)
	{
		Square(eval[i], eval[i]);
		McElieceUtils::Multiply(Inverse[i], Inverse[i - 1], eval[i]);
	}

	Invert(tmp, Inverse[63]);

	for (int cnt = 62; cnt >= 0; cnt--)
	{
		McElieceUtils::Multiply(Inverse[cnt + 1], tmp, Inverse[cnt]);
		McElieceUtils::Multiply(tmp, tmp, eval[cnt + 1]);
	}

	McElieceUtils::Copy(tmp, Inverse[0]);

	for (i = 0; i < 64; i++)
	{
		Output[i][0] = Inverse[i][0] & Received[i];
		Output[i][1] = Inverse[i][1] & Received[i];
		Output[i][2] = Inverse[i][2] & Received[i];
		Output[i][3] = Inverse[i][3] & Received[i];
		Output[i][4] = Inverse[i][4] & Received[i];
		Output[i][5] = Inverse[i][5] & Received[i];
		Output[i][6] = Inverse[i][6] & Received[i];
		Output[i][7] = Inverse[i][7] & Received[i];
		Output[i][8] = Inverse[i][8] & Received[i];
		Output[i][9] = Inverse[i][9] & Received[i];
		Output[i][10] = Inverse[i][10] & Received[i];
		Output[i][11] = Inverse[i][11] & Received[i];
	}
}

void FFTM12T62::ScalingInverse(std::array<std::array<ulong, M>, 64> &Output, std::array<std::array<ulong, M>, 64> &Inverse, std::array<ulong, 64> &Received)
{
	for (size_t i = 0; i < 64; i++)
	{
		Output[i][0] = Inverse[i][0] & Received[i];
		Output[i][1] = Inverse[i][1] & Received[i];
		Output[i][2] = Inverse[i][2] & Received[i];
		Output[i][3] = Inverse[i][3] & Received[i];
		Output[i][4] = Inverse[i][4] & Received[i];
		Output[i][5] = Inverse[i][5] & Received[i];
		Output[i][6] = Inverse[i][6] & Received[i];
		Output[i][7] = Inverse[i][7] & Received[i];
		Output[i][8] = Inverse[i][8] & Received[i];
		Output[i][9] = Inverse[i][9] & Received[i];
		Output[i][10] = Inverse[i][10] & Received[i];
		Output[i][11] = Inverse[i][11] & Received[i];
	}
}

void FFTM12T62::SyndromeAdjust(std::array<std::array<ulong, M>, 2> &Output)
{
	const size_t SASHFT = (128 - T * 2);

	Output[1][0] <<= SASHFT;
	Output[1][0] >>= SASHFT;
	Output[1][1] <<= SASHFT;
	Output[1][1] >>= SASHFT;
	Output[1][2] <<= SASHFT;
	Output[1][2] >>= SASHFT;
	Output[1][3] <<= SASHFT;
	Output[1][3] >>= SASHFT;
	Output[1][4] <<= SASHFT;
	Output[1][4] >>= SASHFT;
	Output[1][5] <<= SASHFT;
	Output[1][5] >>= SASHFT;
	Output[1][6] <<= SASHFT;
	Output[1][6] >>= SASHFT;
	Output[1][7] <<= SASHFT;
	Output[1][7] >>= SASHFT;
	Output[1][8] <<= SASHFT;
	Output[1][8] >>= SASHFT;
	Output[1][9] <<= SASHFT;
	Output[1][9] >>= SASHFT;
	Output[1][10] <<= SASHFT;
	Output[1][10] >>= SASHFT;
	Output[1][11] <<= SASHFT;
	Output[1][11] >>= SASHFT;
}

//~~~Encrypt~~~//

void FFTM12T62::GenE(std::vector<byte> &E, std::unique_ptr<IPrng> &Random)
{
	size_t i;
	size_t j;
	size_t eq;
	ulong mask;
	std::vector<ushort> ind(T);

	while (1)
	{
		Random->Fill(ind, 0, ind.size());

		for (i = 0; i < T; i++) 
		{
			ind[i] &= (static_cast<ushort>(1) << M) - 1;
		}

		eq = 0;
		for (i = 1; i < T; i++)
		{
			for (j = 0; j < i; j++)
			{
				if (ind[i] == ind[j])
				{
					eq = 1;
				}
			}
		}

		if (eq == 0)
		{
			break;
		}
	}

	std::array<ulong, T> val;
	for (j = 0; j < T; j++)
	{
		val[j] = (static_cast<ulong>(1) << (ind[j] & 63));
	}

	std::array<ulong, 64> eInt;
	for (i = 0; i < 64; i++)
	{
		eInt[i] = 0;
		for (j = 0; j < T; j++)
		{
			mask = i ^ (ind[j] >> 6);
			mask -= 1;
			mask >>= 63;
			mask = ~mask + 1;
			eInt[i] |= val[j] & mask;
		}
	}

	IntUtils::LeToBlock(eInt, 0, E, 0, eInt.size() * sizeof(ulong));
}

void FFTM12T62::Syndrome(std::vector<byte> &S, const std::vector<byte> &PublicKey, const std::vector<byte> &E)
{
	const size_t ARRSZE = ((PKN_COLS + 63) / 64); // TODO: intrinsics
	const size_t COLSZE = PKN_COLS / 8;

	std::array<ulong, ARRSZE> eInt;
	MemUtils::Copy(E, SECRET_SIZE, eInt, 0, COLSZE);
	std::array<ulong, ARRSZE> rowInt;
	std::array<ulong, 8> tmp;
	size_t i;
	size_t j;
	int cnt;
	byte b;

	for (i = 0; i < PKN_ROWS; i += 8)
	{
		for (cnt = 0; cnt < 8; cnt++)
		{
			rowInt[ARRSZE - 1] = 0;
			MemUtils::Copy(PublicKey, ((i + cnt) * COLSZE), rowInt, 0, COLSZE);
			tmp[cnt] = 0;

			for (j = 0; j < ARRSZE; j++)
			{
				tmp[cnt] ^= eInt[j] & rowInt[j];
			}
		}

		b = 0;

		for (cnt = 7; cnt >= 0; cnt--)
		{
			tmp[cnt] ^= (tmp[cnt] >> 32);
			tmp[cnt] ^= (tmp[cnt] >> 16);
			tmp[cnt] ^= (tmp[cnt] >> 8);
			tmp[cnt] ^= (tmp[cnt] >> 4);
		}

		for (cnt = 7; cnt >= 0; cnt--)
		{
			b <<= 1;
			b |= (0x6996 >> (tmp[cnt] & 0xF)) & 1;
		}

		S[i / 8] = E[i / 8] ^ b;
	}
}

//~~~KeyGen~~~//

bool FFTM12T62::IrrGen(std::array<ushort, T + 1> &Output, std::vector<ushort> &F)
{
	size_t c;
	size_t i;
	size_t j;
	size_t k;
	ushort inverse;
	ushort mask;
	ushort t;
	bool status;
	std::array<std::array<ushort, T>, T + 1> mat;

	// fill matrix
	mat[0][0] = 1;
	for (i = 1; i < T; i++)
	{
		mat[0][i] = 0;
	}

	for (i = 0; i < T; i++)
	{
		mat[1][i] = F[i];
	}

	for (j = 2; j <= T; j++) 
	{
		MatrixMultiply(mat[j], mat[j - 1], F);
	}

	// gaussian
	for (j = 0; j < T; j++)
	{
		for (k = j + 1; k < T; k++)
		{
			mask = McElieceUtils::Diff(mat[j][j], mat[j][k]);

			for (c = 0; c < T + 1; c++) 
			{
				mat[c][j] ^= mat[c][k] & mask;
			}
		}

		// not invertible
		status = (mat[j][j] != 0);
		if (!status)
		{
			break;
		}

		// compute inverse
		inverse = McElieceUtils::Invert(mat[j][j], M);

		for (c = 0; c < T + 1; c++) 
		{
			mat[c][j] = McElieceUtils::Multiply(mat[c][j], inverse, M);
		}

		for (k = 0; k < T; k++)
		{
			t = mat[j][k];

			if (k != j)
			{
				for (c = 0; c < T + 1; c++)
				{
					mat[c][k] ^= McElieceUtils::Multiply(mat[c][j], t, M);
				}
			}
		}
	}

	if (status)
	{
		for (i = 0; i < T; i++)
		{
			Output[i] = mat[T][i];
		}

		Output[T] = 1;
	}

	return status;
}

void FFTM12T62::SkGen(std::vector<byte> &PrivateKey, std::unique_ptr<Prng::IPrng> &Random)
{
	size_t i;
	std::array<ushort, T + 1> irr;
	std::vector<ushort> f(T);

	while (1)
	{
		Random->Fill(f, 0, f.size());

		for (i = 0; i < T; i++) 
		{
			f[i] &= (static_cast<ushort>(1) << M) - 1;
		}

		if (IrrGen(irr, f))
		{
			break;
		}
	}

	std::array<ulong, M> skInt;
	for (i = 0; i < M; i++)
	{
		skInt[i] = 0;
		for (int cnt = static_cast<int>(irr.size() - 1); cnt >= 0; cnt--)
		{
			skInt[i] <<= 1;
			skInt[i] |= (irr[cnt] >> i) & 1;
		}

		IntUtils::Le64ToBytes(skInt[i], PrivateKey, i * 8);
	}

	std::vector<ulong> cond(CND_SIZE / 8);
	Random->Fill(cond, 0, cond.size());

	for (i = 0; i < CND_SIZE / 8; i++)
	{
		IntUtils::Le64ToBytes(cond[i], PrivateKey, IRR_SIZE + i * 8);
	}
}

bool FFTM12T62::PkGen(std::vector<byte> &PublicKey, const std::vector<byte> &PrivateKey)
{
	size_t c;
	size_t i;
	size_t j;
	size_t k;
	size_t row;
	size_t tail;
	ulong mask;
	ulong u;
	bool status;
	std::array<ulong, M> skInt;

	// compute the inverses
	for (i = 0; i < M; i++)
	{
		skInt[i] = IntUtils::LeBytesTo64(PrivateKey, i * 8);
	}

	std::array<std::array<ulong, M>, 64> eval;
	std::array<std::array<ulong, M>, 64> inverse;
	AdditiveFFT::Transform(eval, skInt);
	McElieceUtils::Copy(eval[0], inverse[0]);

	for (i = 1; i < 64; i++) 
	{
		McElieceUtils::Multiply(inverse[i], inverse[i - 1], eval[i]);
	}

	std::array<ulong, M> tmp;
	Invert(tmp, inverse[63]);

	for (int cnt = 62; cnt >= 0; --cnt)
	{
		McElieceUtils::Multiply(inverse[cnt + 1], tmp, inverse[cnt]);
		McElieceUtils::Multiply(tmp, tmp, eval[cnt + 1]);
	}

	McElieceUtils::Copy(tmp, inverse[0]);
	std::array<std::array<ulong, 64>, PKN_ROWS> mat;

	// fill matrix 
	for (j = 0; j < 64; j++)
	{
		for (k = 0; k < M; k++) 
		{
			mat[k][j] = inverse[j][k];
		}
	}

	for (i = 1; i < T; i++)
	{
		for (j = 0; j < 64; j++)
		{
			McElieceUtils::Multiply(inverse[j], inverse[j], GfPoints[j]);

			for (k = 0; k < M; k++)
			{
				mat[i * M + k][j] = inverse[j][k];
			}
		}
	}

	// permute 
	std::array<ulong, CND_SIZE / 8> cond;
	for (i = 0; i < CND_SIZE / 8; i++)
	{
		cond[i] = IntUtils::LeBytesTo64(PrivateKey, IRR_SIZE + i * 8);
	}

	for (i = 0; i < PKN_ROWS; i++)
	{
		McElieceUtils::BenesCompact(mat[i], cond, 0);
	}

	// gaussian elimination 
	for (i = 0; i < M; i++)
	{
		for (j = 0; j < 64; j++)
		{
			row = i * 64 + j;

			if (row >= PKN_ROWS)
			{
				break;
			}

			for (k = row + 1; k < PKN_ROWS; k++)
			{
				mask = mat[row][i] ^ mat[k][i];
				mask >>= j;
				mask &= 1;
				mask = ~mask + 1;

				for (c = 0; c < 64; c++)
				{
					mat[row][c] ^= mat[k][c] & mask;
				}
			}

			// not invertible
			status = (((mat[row][i] >> j) & 1) != 0);
			if (!status)
			{
				break;
			}

			for (k = 0; k < PKN_ROWS; k++)
			{
				if (k != row)
				{
					mask = mat[k][i] >> j;
					mask &= 1;
					mask = ~mask + 1;

					for (c = 0; c < 64; c++)
					{
						mat[k][c] ^= mat[row][c] & mask;
					}
				}
			}
		}

		if (!status)
		{
			break;
		}
	}

	if (status)
	{
		// store pk
		tail = (PKN_ROWS & 63) >> 3;
		size_t pos = 0;

		for (i = 0; i < PKN_ROWS; i++)
		{
			u = mat[i][(PKN_ROWS + 63) / 64 - 1];

			for (k = tail; k < 8; k++)
			{
				PublicKey[pos + (k - tail)] = (u >> (8 * k)) & 0xFF;
			}

			pos += 8 - tail;

			for (j = M; j < 64; j++)
			{
				IntUtils::Le64ToBytes(mat[i][j], PublicKey, pos);
				pos += 8;
			}
		}
	}

	return status;
}

//~~~FFT~~~//

void FFTM12T62::AdditiveFFT::Transform(std::array<std::array<ulong, M>, 64> &Output, std::array<ulong, M> &Input)
{
	RadixConversions(Input);
	Butterflies(Output, Input);
}

void FFTM12T62::AdditiveFFT::Butterflies(std::array<std::array<ulong, M>, 64> &Output, std::array<ulong, M> &Input)
{
	size_t b;
	size_t i;
	size_t j;
	size_t k;
	size_t s;
	size_t pos;

	static const std::array<byte, 64> ButterflyReverse =
	{
		0x00, 0x20, 0x10, 0x30, 0x08, 0x28, 0x18, 0x38, 
		0x04, 0x24, 0x14, 0x34, 0x0C, 0x2C, 0x1C, 0x3C,
		0x02, 0x22, 0x12, 0x32, 0x0A, 0x2A, 0x1A, 0x3A, 
		0x06, 0x26, 0x16, 0x36, 0x0E, 0x2E, 0x1E, 0x3E,
		0x01, 0x21, 0x11, 0x31, 0x09, 0x29, 0x19, 0x39, 
		0x05, 0x25, 0x15, 0x35, 0x0D, 0x2D, 0x1D, 0x3D,
		0x03, 0x23, 0x13, 0x33, 0x0B, 0x2B, 0x1B, 0x3B, 
		0x07, 0x27, 0x17, 0x37, 0x0F, 0x2F, 0x1F, 0x3F
	};

	// broadcast
	for (j = 0; j < 64; j++)
	{
		Output[j][0] = (Input[0] >> ButterflyReverse[j]) & 1;
		Output[j][0] = ~Output[j][0] + 1;
		Output[j][1] = (Input[1] >> ButterflyReverse[j]) & 1;
		Output[j][1] = ~Output[j][1] + 1;
		Output[j][2] = (Input[2] >> ButterflyReverse[j]) & 1;
		Output[j][2] = ~Output[j][2] + 1;
		Output[j][3] = (Input[3] >> ButterflyReverse[j]) & 1;
		Output[j][3] = ~Output[j][3] + 1;
		Output[j][4] = (Input[4] >> ButterflyReverse[j]) & 1;
		Output[j][4] = ~Output[j][4] + 1;
		Output[j][5] = (Input[5] >> ButterflyReverse[j]) & 1;
		Output[j][5] = ~Output[j][5] + 1;
		Output[j][6] = (Input[6] >> ButterflyReverse[j]) & 1;
		Output[j][6] = ~Output[j][6] + 1;
		Output[j][7] = (Input[7] >> ButterflyReverse[j]) & 1;
		Output[j][7] = ~Output[j][7] + 1;
		Output[j][8] = (Input[8] >> ButterflyReverse[j]) & 1;
		Output[j][8] = ~Output[j][8] + 1;
		Output[j][9] = (Input[9] >> ButterflyReverse[j]) & 1;
		Output[j][9] = ~Output[j][9] + 1;
		Output[j][10] = (Input[10] >> ButterflyReverse[j]) & 1;
		Output[j][10] = ~Output[j][10] + 1;
		Output[j][11] = (Input[11] >> ButterflyReverse[j]) & 1;
		Output[j][11] = ~Output[j][11] + 1;
	}

	pos = 0;
	std::array<ulong, M> tmp;

	// butterflies
	for (i = 0; i <= 5; i++)
	{
		s = static_cast<size_t>(1) << i;

		// butterflies
		for (i = 0; i <= 5; i++)
		{
			s = static_cast<size_t>(1) << i;

			for (j = 0; j < 64; j += 2 * s)
			{
				for (k = j; k < j + s; k++)
				{
					McElieceUtils::Multiply(tmp, Output[k + s], ButterflyConsts[pos + (k - j)]);

					// memory tiling
					for (b = 0; b < M; b++)
					{
						Output[k][b] ^= tmp[b];
					}

					for (b = 0; b < M; b++)
					{
						Output[k + s][b] ^= Output[k][b];
					}
				}
			}

			pos += (static_cast<size_t>(1) << i);
		}

		pos += (static_cast<size_t>(1) << i);
	}
}

void FFTM12T62::AdditiveFFT::RadixConversions(std::array<ulong, M> &Output)
{
	size_t i;
	size_t j;
	int cnt;

	static const std::array<std::array<ulong, 2>, 5> RadixMask =
	{
		{
			{ 0x8888888888888888ULL, 0x4444444444444444ULL },
			{ 0xC0C0C0C0C0C0C0C0ULL, 0x3030303030303030ULL },
			{ 0xF000F000F000F000ULL, 0x0F000F000F000F00ULL },
			{ 0xFF000000FF000000ULL, 0x00FF000000FF0000ULL },
			{ 0xFFFF000000000000ULL, 0x0000FFFF00000000ULL }
		}
	};

	static const std::array<std::array<ulong, 12>, 5> RadixScalar =
	{
		{
			{
				0xF3CFC030FC30F003ULL, 0x3FCF0F003C00C00CULL, 0x30033CC300C0C03CULL, 0xCCFF0F3C0F30F0C0ULL,
				0x0300C03FF303C3F0ULL, 0x3FFF3C0FF0CCCCC0ULL, 0xF3FFF0C00F3C3CC0ULL, 0x3003333FFFC3C000ULL,
				0x0FF30FFFC3FFF300ULL, 0xFFC0F300F0F0CC00ULL, 0xC0CFF3FCCC3CFC00ULL, 0xFC3C03F0F330C000ULL,
			},
			{
				0x000F00000000F00FULL, 0x00000F00F00000F0ULL, 0x0F00000F00000F00ULL, 0xF00F00F00F000000ULL,
				0x00F00000000000F0ULL, 0x0000000F00000000ULL, 0xF00000000F00F000ULL, 0x00F00F00000F0000ULL,
				0x0000F00000F00F00ULL, 0x000F00F00F00F000ULL, 0x00F00F0000000000ULL, 0x0000000000F00000ULL,
			},
			{
				0x0000FF00FF0000FFULL, 0x0000FF000000FF00ULL, 0xFF0000FF00FF0000ULL, 0xFFFF0000FF000000ULL,
				0x00FF00FF00FF0000ULL, 0x0000FFFFFF000000ULL, 0x00FFFF00FF000000ULL, 0xFFFFFF0000FF0000ULL,
				0xFFFF00FFFF00FF00ULL, 0x0000FF0000000000ULL, 0xFFFFFF00FF000000ULL, 0x00FF000000000000ULL,
			},
			{
				0x000000000000FFFFULL, 0x00000000FFFF0000ULL, 0x0000000000000000ULL, 0xFFFF000000000000ULL,
				0x00000000FFFF0000ULL, 0x0000FFFF00000000ULL, 0x0000000000000000ULL, 0x00000000FFFF0000ULL,
				0x0000FFFF00000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			},
			{
				0x00000000FFFFFFFFULL, 0xFFFFFFFF00000000ULL, 0xFFFFFFFF00000000ULL, 0x0000000000000000ULL,
				0x0000000000000000ULL, 0xFFFFFFFF00000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
				0xFFFFFFFF00000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL, 0x0000000000000000ULL,
			}
		}
	};

	// scaling
	for (i = 0; i <= 4; i++)
	{
		for (j = 0; j < M; j++)
		{
			for (cnt = 4; cnt >= static_cast<int>(i); --cnt)
			{
				Output[j] ^= (Output[j] & RadixMask[cnt][0]) >> (static_cast<int>(1) << cnt);
				Output[j] ^= (Output[j] & RadixMask[cnt][1]) >> (static_cast<int>(1) << cnt);
			}
		}

		McElieceUtils::Multiply(Output, Output, RadixScalar[i]);
	}
}

void FFTM12T62::TransposedFFT::Transform(std::array<std::array<ulong, M>, 2> &Output, std::array<std::array<ulong, M>, 64> &Input)
{
	Butterflies(Output, Input);
	RadixConversions(Output);
}

void FFTM12T62::TransposedFFT::Butterflies(std::array<std::array<ulong, M>, 2> &Output, std::array<std::array<ulong, M>, 64> &Input)
{
	size_t i;
	size_t j;
	size_t k;
	size_t s;
	size_t pos = 63;
	int cnt;
	std::array<ulong, M> tmp;

	// butterflies
	for (cnt = 5; cnt >= 0; --cnt)
	{
		s = static_cast<size_t>(1) << cnt;
		pos -= s;

		for (j = 0; j < 64; j += 2 * s)
		{
			for (k = j; k < j + s; k++)
			{
				McElieceUtils::Add(Input[k], Input[k + s]);
				McElieceUtils::Multiply(tmp, Input[k], ButterflyConsts[pos + (k - j)]);
				McElieceUtils::Add(Input[k + s], tmp);
			}
		}
	}

	// transpose
	static const std::array<byte, 64> ButterflyReverse =
	{
		0x00, 0x20, 0x10, 0x30, 0x08, 0x28, 0x18, 0x38,
		0x04, 0x24, 0x14, 0x34, 0x0C, 0x2C, 0x1C, 0x3C,
		0x02, 0x22, 0x12, 0x32, 0x0A, 0x2A, 0x1A, 0x3A,
		0x06, 0x26, 0x16, 0x36, 0x0E, 0x2E, 0x1E, 0x3E,
		0x01, 0x21, 0x11, 0x31, 0x09, 0x29, 0x19, 0x39,
		0x05, 0x25, 0x15, 0x35, 0x0D, 0x2D, 0x1D, 0x3D,
		0x03, 0x23, 0x13, 0x33, 0x0B, 0x2B, 0x1B, 0x3B,
		0x07, 0x27, 0x17, 0x37, 0x0F, 0x2F, 0x1F, 0x3F
	};

	std::array<ulong, 64> buf;
	for (i = 0; i < M; i++)
	{
		for (j = 0; j < 64; j++) 
		{
			buf[ButterflyReverse[j]] = Input[j][i];
		}

		McElieceUtils::TransposeCompact64x64(buf);

		for (j = 0; j < 64; j++)
		{
			Input[j][i] = buf[j];
		}
	}

	// broadcast
	std::array<std::array<ulong, M>, 6> pre;
	McElieceUtils::Copy(Input[32], pre[0]);
	McElieceUtils::Add(Input[33], Input[32]);
	McElieceUtils::Copy(Input[33], pre[1]);
	McElieceUtils::Add(Input[35], Input[33]);
	McElieceUtils::Add(pre[0], Input[35]);
	McElieceUtils::Add(Input[34], Input[35]);
	McElieceUtils::Copy(Input[34], pre[2]);
	McElieceUtils::Add(Input[38], Input[34]);
	McElieceUtils::Add(pre[0], Input[38]);
	McElieceUtils::Add(Input[39], Input[38]);
	McElieceUtils::Add(pre[1], Input[39]);
	McElieceUtils::Add(Input[37], Input[39]);
	McElieceUtils::Add(pre[0], Input[37]);
	McElieceUtils::Add(Input[36], Input[37]);
	McElieceUtils::Copy(Input[36], pre[3]);
	McElieceUtils::Add(Input[44], Input[36]);
	McElieceUtils::Add(pre[0], Input[44]);
	McElieceUtils::Add(Input[45], Input[44]);
	McElieceUtils::Add(pre[1], Input[45]);
	McElieceUtils::Add(Input[47], Input[45]);
	McElieceUtils::Add(pre[0], Input[47]);
	McElieceUtils::Add(Input[46], Input[47]);
	McElieceUtils::Add(pre[2], Input[46]);
	McElieceUtils::Add(Input[42], Input[46]);
	McElieceUtils::Add(pre[0], Input[42]);
	McElieceUtils::Add(Input[43], Input[42]);
	McElieceUtils::Add(pre[1], Input[43]);
	McElieceUtils::Add(Input[41], Input[43]);
	McElieceUtils::Add(pre[0], Input[41]);
	McElieceUtils::Add(Input[40], Input[41]);
	McElieceUtils::Copy(Input[40], pre[4]);
	McElieceUtils::Add(Input[56], Input[40]);
	McElieceUtils::Add(pre[0], Input[56]);
	McElieceUtils::Add(Input[57], Input[56]);
	McElieceUtils::Add(pre[1], Input[57]);
	McElieceUtils::Add(Input[59], Input[57]);
	McElieceUtils::Add(pre[0], Input[59]);
	McElieceUtils::Add(Input[58], Input[59]);
	McElieceUtils::Add(pre[2], Input[58]);
	McElieceUtils::Add(Input[62], Input[58]);
	McElieceUtils::Add(pre[0], Input[62]);
	McElieceUtils::Add(Input[63], Input[62]);
	McElieceUtils::Add(pre[1], Input[63]);
	McElieceUtils::Add(Input[61], Input[63]);
	McElieceUtils::Add(pre[0], Input[61]);
	McElieceUtils::Add(Input[60], Input[61]);
	McElieceUtils::Add(pre[3], Input[60]);
	McElieceUtils::Add(Input[52], Input[60]);
	McElieceUtils::Add(pre[0], Input[52]);
	McElieceUtils::Add(Input[53], Input[52]);
	McElieceUtils::Add(pre[1], Input[53]);
	McElieceUtils::Add(Input[55], Input[53]);
	McElieceUtils::Add(pre[0], Input[55]);
	McElieceUtils::Add(Input[54], Input[55]);
	McElieceUtils::Add(pre[2], Input[54]);
	McElieceUtils::Add(Input[50], Input[54]);
	McElieceUtils::Add(pre[0], Input[50]);
	McElieceUtils::Add(Input[51], Input[50]);
	McElieceUtils::Add(pre[1], Input[51]);
	McElieceUtils::Add(Input[49], Input[51]);
	McElieceUtils::Add(pre[0], Input[49]);
	McElieceUtils::Add(Input[48], Input[49]);
	McElieceUtils::Copy(Input[48], pre[5]);
	McElieceUtils::Add(Input[16], Input[48]);
	McElieceUtils::Add(pre[0], Input[16]);
	McElieceUtils::Add(Input[17], Input[16]);
	McElieceUtils::Add(pre[1], Input[17]);
	McElieceUtils::Add(Input[19], Input[17]);
	McElieceUtils::Add(pre[0], Input[19]);
	McElieceUtils::Add(Input[18], Input[19]);
	McElieceUtils::Add(pre[2], Input[18]);
	McElieceUtils::Add(Input[22], Input[18]);
	McElieceUtils::Add(pre[0], Input[22]);
	McElieceUtils::Add(Input[23], Input[22]);
	McElieceUtils::Add(pre[1], Input[23]);
	McElieceUtils::Add(Input[21], Input[23]);
	McElieceUtils::Add(pre[0], Input[21]);
	McElieceUtils::Add(Input[20], Input[21]);
	McElieceUtils::Add(pre[3], Input[20]);
	McElieceUtils::Add(Input[28], Input[20]);
	McElieceUtils::Add(pre[0], Input[28]);
	McElieceUtils::Add(Input[29], Input[28]);
	McElieceUtils::Add(pre[1], Input[29]);
	McElieceUtils::Add(Input[31], Input[29]);
	McElieceUtils::Add(pre[0], Input[31]);
	McElieceUtils::Add(Input[30], Input[31]);
	McElieceUtils::Add(pre[2], Input[30]);
	McElieceUtils::Add(Input[26], Input[30]);
	McElieceUtils::Add(pre[0], Input[26]);
	McElieceUtils::Add(Input[27], Input[26]);
	McElieceUtils::Add(pre[1], Input[27]);
	McElieceUtils::Add(Input[25], Input[27]);
	McElieceUtils::Add(pre[0], Input[25]);
	McElieceUtils::Add(Input[24], Input[25]);
	McElieceUtils::Add(pre[4], Input[24]);
	McElieceUtils::Add(Input[8], Input[24]);
	McElieceUtils::Add(pre[0], Input[8]);
	McElieceUtils::Add(Input[9], Input[8]);
	McElieceUtils::Add(pre[1], Input[9]);
	McElieceUtils::Add(Input[11], Input[9]);
	McElieceUtils::Add(pre[0], Input[11]);
	McElieceUtils::Add(Input[10], Input[11]);
	McElieceUtils::Add(pre[2], Input[10]);
	McElieceUtils::Add(Input[14], Input[10]);
	McElieceUtils::Add(pre[0], Input[14]);
	McElieceUtils::Add(Input[15], Input[14]);
	McElieceUtils::Add(pre[1], Input[15]);
	McElieceUtils::Add(Input[13], Input[15]);
	McElieceUtils::Add(pre[0], Input[13]);
	McElieceUtils::Add(Input[12], Input[13]);
	McElieceUtils::Add(pre[3], Input[12]);
	McElieceUtils::Add(Input[4], Input[12]);
	McElieceUtils::Add(pre[0], Input[4]);
	McElieceUtils::Add(Input[5], Input[4]);
	McElieceUtils::Add(pre[1], Input[5]);
	McElieceUtils::Add(Input[7], Input[5]);
	McElieceUtils::Add(pre[0], Input[7]);
	McElieceUtils::Add(Input[6], Input[7]);
	McElieceUtils::Add(pre[2], Input[6]);
	McElieceUtils::Add(Input[2], Input[6]);
	McElieceUtils::Add(pre[0], Input[2]);
	McElieceUtils::Add(Input[3], Input[2]);
	McElieceUtils::Add(pre[1], Input[3]);
	McElieceUtils::Add(Input[1], Input[3]);
	McElieceUtils::Add(pre[0], Input[1]);
	McElieceUtils::Add(Output[0], Input[0], Input[1]);

	const ushort beta[6] =
	{
		8, 1300, 3408, 1354, 2341, 1154
	};

	for (j = 0; j < M; j++)
	{
		tmp[j] = (beta[0] >> j) & 1;
		tmp[j] = ~tmp[j] + 1;
	}

	McElieceUtils::Multiply(Output[1], pre[0], tmp);

	for (i = 1; i < 6; i++)
	{
		for (j = 0; j < M; j++)
		{
			tmp[j] = (beta[i] >> j) & 1;
			tmp[j] = ~tmp[j] + 1;
		}

		McElieceUtils::Multiply(tmp, pre[i], tmp);
		McElieceUtils::Add(Output[1], tmp);
	}
}

void FFTM12T62::TransposedFFT::RadixConversions(std::array<std::array<ulong, M>, 2> &Output)
{
	size_t i;
	size_t j;
	int cnt;

	static const std::array<std::array<ulong, 2>, 6> RadixTrMask =
	{
		{
			{ 0x2222222222222222ULL, 0x4444444444444444ULL },
			{ 0x0C0C0C0C0C0C0C0CULL, 0x3030303030303030ULL },
			{ 0x00F000F000F000F0ULL, 0x0F000F000F000F00ULL },
			{ 0x0000FF000000FF00ULL, 0x00FF000000FF0000ULL },
			{ 0x00000000FFFF0000ULL, 0x0000FFFF00000000ULL },
			{ 0xFFFFFFFF00000000ULL, 0x00000000FFFFFFFFULL }
		}
	};

	for (cnt = 5; cnt >= 0; --cnt)
	{
		if (cnt < 5)
		{
			McElieceUtils::Multiply(Output[0], Output[0], RadixTrScalar[cnt][0]);
			McElieceUtils::Multiply(Output[1], Output[1], RadixTrScalar[cnt][1]);
		}

		for (i = 0; i < M; i++)
		{
			for (j = static_cast<size_t>(cnt); j <= 4; j++)
			{
				Output[0][i] ^= (Output[0][i] & RadixTrMask[j][0]) << (static_cast<int>(1) << j);
				Output[0][i] ^= (Output[0][i] & RadixTrMask[j][1]) << (static_cast<int>(1) << j);
				Output[1][i] ^= (Output[1][i] & RadixTrMask[j][0]) << (static_cast<int>(1) << j);
				Output[1][i] ^= (Output[1][i] & RadixTrMask[j][1]) << (static_cast<int>(1) << j);
			}
		}

		for (i = 0; i < M; i++)
		{
			Output[1][i] ^= (Output[0][i] & RadixTrMask[5][0]) >> 32;
			Output[1][i] ^= (Output[1][i] & RadixTrMask[5][1]) << 32;
		}
	}
}

//~~~Utils~~~//

void FFTM12T62::Invert(std::array<ulong, M> &Output, const std::array<ulong, M> &Input)
{
	std::array<ulong, M> tmpA;
	std::array<ulong, M> tmpB;

	McElieceUtils::Copy(Input, Output);
	Square(Output, Output);
	McElieceUtils::Multiply(tmpA, Output, Input);
	Square(Output, tmpA);
	Square(Output, Output);
	McElieceUtils::Multiply(tmpB, Output, tmpA);
	Square(Output, tmpB);
	Square(Output, Output);
	Square(Output, Output);
	Square(Output, Output);
	McElieceUtils::Multiply(Output, Output, tmpB);
	Square(Output, Output);
	Square(Output, Output);
	McElieceUtils::Multiply(Output, Output, tmpA);
	Square(Output, Output);
	McElieceUtils::Multiply(Output, Output, Input);
	Square(Output, Output);
}

void FFTM12T62::MatrixMultiply(std::array<ushort, T> &Output, std::array<ushort, T> &A, std::vector<ushort> &B)
{
	size_t i;
	size_t j;

	std::vector<ushort> tmp(123, 0);

	for (i = 0; i < 62; i++)
	{
		for (j = 0; j < 62; j++)
		{
			tmp[i + j] ^= McElieceUtils::Multiply(A[i], B[j], M);
		}
	}

	for (i = 122; i >= 62; i--)
	{
		tmp[i - 55] ^= McElieceUtils::Multiply(tmp[i], static_cast<ushort>(1763), M);
		tmp[i - 61] ^= McElieceUtils::Multiply(tmp[i], static_cast<ushort>(1722), M);
		tmp[i - 62] ^= McElieceUtils::Multiply(tmp[i], static_cast<ushort>(4033), M);
	}

	for (i = 0; i < 62; i++) 
	{
		Output[i] = tmp[i];
	}
}

void FFTM12T62::Square(std::array<ulong, M> &Output, std::array<ulong, M> &Input)
{
	std::array<ulong, M> sum;

	sum[0] = Input[0] ^ Input[6];
	sum[1] = Input[11];
	sum[2] = Input[1] ^ Input[7];
	sum[3] = Input[6];
	sum[4] = Input[2] ^ Input[11] ^ Input[8];
	sum[5] = Input[7];
	sum[6] = Input[3] ^ Input[9];
	sum[7] = Input[8];
	sum[8] = Input[4] ^ Input[10];
	sum[9] = Input[9];
	sum[10] = Input[5] ^ Input[11];
	sum[11] = Input[10];

	MemUtils::Copy(sum, 0, Output, 0, M * sizeof(ulong));
}

NAMESPACE_MCELIECEEND

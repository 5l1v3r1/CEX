#ifndef _CEX_NTTQ7681N256_H
#define _CEX_NTTQ7681N256_H

#include "CexDomain.h"

NAMESPACE_RINGLWE

/// <summary>
/// The Q:7681 N:256 RingLWE parameter set
/// </summary>
struct NTTQ7681N256
{
public:

	static const int FWD_CONST1 = 5118;
	static const int FWD_CONST2 = 1065;
	static const int HAMMING_TABLE_SIZE = 8;
	static const int INVCONST1 = 2880;
	static const int INVCONST2 = 3383;
	static const int INVCONST3 = 2481;
	static const int KN_DISTANCE1_MASK = 7;
	static const int KN_DISTANCE2_MASK = 15;
	static const int N = 256;
	static const int PMAT_MAX_COL = 109;
	static const int Q = 7681;
	static const int QBY2 = 3840;
	static const int QBY4 = 1920;
	static const int QBY4_TIMES3 = 5760;
	static const int SCALING = 7651;

	const std::vector<ushort> PrimeRtOmegaTable =
	{ 
		7680, 4298, 6468, 849, 2138, 3654, 1714, 5118 
	};

	const std::vector<ushort> PrimeRtInvOmegaTable =
	{ 
		7680, 3383, 5756, 1728, 7584, 6569, 6601 
	};

	const std::vector<byte> Lut1 =
	{
		3, 4, 1, 2, 2, 8, 6, 1, 3, 0, 1, 9, 2, 5, 5, 4, 3, 4, 1, 1, 2, 7, 6, 11, 3, 0, 1, 4, 2, 4, 5, 2, 3, 4, 1, 2, 2, 8, 6, 0, 3, 0, 1, 7, 2, 5, 
		5, 12, 3, 4, 1, 1, 2, 7, 6, 9, 3, 0, 1, 3, 2, 4, 5, 19, 3, 4, 1, 2, 2, 8, 6, 1, 3, 0, 1, 9, 2, 5, 5, 0, 3, 4, 1, 1, 2, 7, 6, 10, 3, 0, 1, 
		4, 2, 4, 5, 17, 3, 4, 1, 2, 2, 8, 6, 0, 3, 0, 1, 7, 2, 5, 5, 8, 3, 4, 1, 1, 2, 7, 6, 6, 3, 0, 1, 3, 2, 4, 5, 21, 3, 4, 1, 2, 2, 8, 6, 1, 
		3, 0, 1, 9, 2, 5, 5, 4, 3, 4, 1, 1, 2, 7, 6, 11, 3, 0, 1, 4, 2, 4, 5, 16, 3, 4, 1, 2, 2, 8, 6, 0, 3, 0, 1, 7, 2, 5, 5, 10, 3, 4, 1, 1, 2, 
		7, 6, 9, 3, 0, 1, 3, 2, 4, 5, 20, 3, 4, 1, 2, 2, 8, 6, 1, 3, 0, 1, 9, 2, 5, 5, 0, 3, 4, 1, 1, 2, 7, 6, 10, 3, 0, 1, 4, 2, 4, 5, 18, 3, 4, 
		1, 2, 2, 8, 6, 0, 3, 0, 1, 7, 2, 5, 5, 7, 3, 4, 1, 1, 2, 7, 6, 6, 3, 0, 1, 3, 2, 4, 5, 22
	};

	const std::vector<byte> Lut2 =
	{
		13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 13, 10, 7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 
		7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 7, 6, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 5, 4, 0, 14, 0, 12, 
		0, 14, 0, 12, 0, 14, 0, 12, 0, 14, 0, 12, 0, 14, 0, 12, 0, 14, 0, 12, 0, 14, 0, 12, 0, 14, 0, 12, 11, 8, 10, 3, 11, 8, 10, 3, 11, 8, 10, 3, 11, 8, 10, 3, 11, 8, 10, 
		3, 11, 8, 10, 3, 11, 8, 10, 3, 11, 8, 10, 3, 15, 8, 10, 1, 13, 6, 9, 16, 15, 8, 10, 1, 13, 6, 9, 14, 15, 8, 10, 1, 13, 6, 9, 16, 15, 8, 10, 1, 13, 6, 9, 14, 13, 14, 
		7, 35, 11, 0, 0, 39, 12, 7, 6, 37, 9, 33, 17, 41, 13, 8, 7, 36, 11, 32, 0, 40, 12, 4, 6, 38, 9, 34, 15, 42
	};

	const std::vector<uint> PmatColsSmallLow =
	{
		388697, 61898, 735029, 1827984, 90835, 3806095, 6691108, 2935960, 12945421, 28568525, 3210654, 48767208, 16573744, 125916607, 72293821, 194429505, 
		151121284, 293488680, 409973800, 564029604, 831569570, 1557025050, 1665606779, 2457231006, 610122653, 3777752934, 2824776995, 1961497217, 3774769494, 2504584397, 375812815, 1179964722, 
		118525731, 3587291686, 933817073, 790620719, 666896237, 3054471770, 4025728199, 2311598504, 4001600372, 18287413, 431859238, 386648341, 2865711183, 2193001056, 879136978, 3755515272, 
		3027306685, 2105184250, 3767100803, 2422537634, 3546375370, 854226919, 1231318387, 2442556162, 3172751346, 3914369751, 2810198103, 2171449999, 3050259270, 698423236, 583750470, 3513591151, 
		3813875465, 3101913469, 1109666353, 1237942877, 3992491021, 3153069412, 3875863403, 85509522, 1610972899, 3991997174, 884082284, 847230089, 633423750, 3943696550, 1797094335, 562330178, 
		731587459, 349044622, 3613052414, 2199722836, 4039471985, 3316520954, 402856197, 2120698321, 3953201766, 1934940481, 2746892350, 4232178428, 317690021, 3599046439, 2276896413, 2345760036
	};

	const std::vector<uint> PmatColsSmallHigh =
	{
		0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
		0, 0, 0, 0, 0, 0, 0, 0, 0, 512, 0, 0, 1536, 1536, 3072, 3584, 
		5632, 1024, 512, 12800, 11776, 19968, 2048, 8704, 33280, 10752, 55296, 81920, 126464, 2048, 233472, 167936, 
		444416, 180224, 59904, 537600, 27136, 86528, 1435136, 831488, 460800, 2417152, 1606656, 898048, 829440, 5262848, 4853760, 6870528, 
		9718784, 14221824, 1589248, 22264832, 11726336, 23811072, 38793216, 9927168, 30364160, 11720192, 89426432, 13959680, 68004352, 223820288, 101885440, 75010048, 
		104050688, 297858048, 204479488, 519882240, 400561152, 728174592, 992103424, 573408768, 1519038976, 584817152, 348388864, 216653312, 3563907072, 1151563264, 2583073280, 2136579584
	};
};

NAMESPACE_RINGLWEEND
#endif
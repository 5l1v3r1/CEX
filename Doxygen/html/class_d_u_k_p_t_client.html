<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.18"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CEX++: DUKPTClient Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CEX++
   &#160;<span id="projectnumber">1.0.0.8f</span>
   </div>
   <div id="projectbrief">The CEX Cryptographic Library in C++</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.18 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="class_d_u_k_p_t_client-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">DUKPTClient Class Reference<span class="mlabels"><span class="mlabel">final</span></span></div>  </div>
</div><!--header-->
<div class="contents">

<p>A C++ implementation of the ANSI X9.24-3 2017 DUKPT.  
 <a href="class_d_u_k_p_t_client.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_d_u_k_p_t_client_8h_source.html">DUKPTClient.h</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a3a73382729cae3fb3ae479a7b19d55d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#a3a73382729cae3fb3ae479a7b19d55d0">DUKPTClient</a> ()</td></tr>
<tr class="memdesc:a3a73382729cae3fb3ae479a7b19d55d0"><td class="mdescLeft">&#160;</td><td class="mdescRight">The DUKPT constructor  <a href="class_d_u_k_p_t_client.html#a3a73382729cae3fb3ae479a7b19d55d0">More...</a><br /></td></tr>
<tr class="separator:a3a73382729cae3fb3ae479a7b19d55d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6bdd17cd6d1a4e624dbf8dd24fbdc43"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#ac6bdd17cd6d1a4e624dbf8dd24fbdc43">~DUKPTClient</a> ()</td></tr>
<tr class="memdesc:ac6bdd17cd6d1a4e624dbf8dd24fbdc43"><td class="mdescLeft">&#160;</td><td class="mdescRight">The DUKPT destructor  <a href="class_d_u_k_p_t_client.html#ac6bdd17cd6d1a4e624dbf8dd24fbdc43">More...</a><br /></td></tr>
<tr class="separator:ac6bdd17cd6d1a4e624dbf8dd24fbdc43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca4512f7b2ebedfe3d385d78edaac77"><td class="memItemLeft" align="right" valign="top">uint&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#aaca4512f7b2ebedfe3d385d78edaac77">TransactionCounter</a> ()</td></tr>
<tr class="memdesc:aaca4512f7b2ebedfe3d385d78edaac77"><td class="mdescLeft">&#160;</td><td class="mdescRight">The current transaction key register  <a href="class_d_u_k_p_t_client.html#aaca4512f7b2ebedfe3d385d78edaac77">More...</a><br /></td></tr>
<tr class="separator:aaca4512f7b2ebedfe3d385d78edaac77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1cb5d7b078d029d3fb3a85bf7bc1925"><td class="memItemLeft" align="right" valign="top">std::vector&lt; byte &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#ad1cb5d7b078d029d3fb3a85bf7bc1925">EncryptAuthenticate</a> (const std::vector&lt; byte &gt; &amp;<a class="el" href="group___enumeration.html#gga0275357fcdd6da6fb73a7cb04b0d8f8ea4c2a8fe7eaf24721cc7a9f0175115bd4">Message</a>, const std::vector&lt; byte &gt; &amp;AdditionalData)</td></tr>
<tr class="memdesc:ad1cb5d7b078d029d3fb3a85bf7bc1925"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt and authenticate a PIN message.  <a href="class_d_u_k_p_t_client.html#ad1cb5d7b078d029d3fb3a85bf7bc1925">More...</a><br /></td></tr>
<tr class="separator:ad1cb5d7b078d029d3fb3a85bf7bc1925"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee398ff7d2658a6a20ee15ef190d4992"><td class="memItemLeft" align="right" valign="top">std::vector&lt; byte &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#aee398ff7d2658a6a20ee15ef190d4992">Encrypt</a> (const std::vector&lt; byte &gt; &amp;<a class="el" href="group___enumeration.html#gga0275357fcdd6da6fb73a7cb04b0d8f8ea4c2a8fe7eaf24721cc7a9f0175115bd4">Message</a>)</td></tr>
<tr class="memdesc:aee398ff7d2658a6a20ee15ef190d4992"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a PIN message  <a href="class_d_u_k_p_t_client.html#aee398ff7d2658a6a20ee15ef190d4992">More...</a><br /></td></tr>
<tr class="separator:aee398ff7d2658a6a20ee15ef190d4992"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69f763e256f74571574230b63f07154b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; byte &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#a69f763e256f74571574230b63f07154b">GenerateWorkingKeys</a> (DukptKeyUsage WorkingKeyUsage, DukptKeyType WorkingKeyType)</td></tr>
<tr class="memdesc:a69f763e256f74571574230b63f07154b"><td class="mdescLeft">&#160;</td><td class="mdescRight">B.6.3 The GenerateWorkingKeys function generates a working key for the current transaction  <a href="class_d_u_k_p_t_client.html#a69f763e256f74571574230b63f07154b">More...</a><br /></td></tr>
<tr class="separator:a69f763e256f74571574230b63f07154b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0efdad923f944a7f59bd1d9332fc8232"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#a0efdad923f944a7f59bd1d9332fc8232">LoadInitialKey</a> (const std::vector&lt; byte &gt; &amp;InitialKey, DukptKeyType DeriveKeyType, const std::vector&lt; byte &gt; &amp;InitialKeyId)</td></tr>
<tr class="memdesc:a0efdad923f944a7f59bd1d9332fc8232"><td class="mdescLeft">&#160;</td><td class="mdescRight">B.6.3 Processing Routines; Load an initial key for computing terminal transaction keys in sequence  <a href="class_d_u_k_p_t_client.html#a0efdad923f944a7f59bd1d9332fc8232">More...</a><br /></td></tr>
<tr class="separator:a0efdad923f944a7f59bd1d9332fc8232"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab84122de63b8771a05bed555ccac2c8c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_d_u_k_p_t_client.html#ab84122de63b8771a05bed555ccac2c8c">UpdateInitialKey</a> (const std::vector&lt; byte &gt; &amp;EncryptedInitialKey, DukptKeyType InitialKeyType, const std::vector&lt; byte &gt; &amp;NewDeviceId)</td></tr>
<tr class="memdesc:ab84122de63b8771a05bed555ccac2c8c"><td class="mdescLeft">&#160;</td><td class="mdescRight">B.6.3 Update Initial Key; Load a new terminal initial key under a pre-existing terminal initial key  <a href="class_d_u_k_p_t_client.html#ab84122de63b8771a05bed555ccac2c8c">More...</a><br /></td></tr>
<tr class="separator:ab84122de63b8771a05bed555ccac2c8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>A C++ implementation of the ANSI X9.24-3 2017 DUKPT. </p>
<p>Translated from the official Python implementation:  Test Vectors: </p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a3a73382729cae3fb3ae479a7b19d55d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a73382729cae3fb3ae479a7b19d55d0">&#9670;&nbsp;</a></span>DUKPTClient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DUKPTClient::DUKPTClient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The DUKPT constructor </p>

</div>
</div>
<a id="ac6bdd17cd6d1a4e624dbf8dd24fbdc43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6bdd17cd6d1a4e624dbf8dd24fbdc43">&#9670;&nbsp;</a></span>~DUKPTClient()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">DUKPTClient::~DUKPTClient </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The DUKPT destructor </p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aee398ff7d2658a6a20ee15ef190d4992"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aee398ff7d2658a6a20ee15ef190d4992">&#9670;&nbsp;</a></span>Encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; byte &gt; DUKPTClient::Encrypt </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>Message</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a PIN message </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Message</td><td>The PIN message to encrypt</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The encrypted message</dd></dl>

</div>
</div>
<a id="ad1cb5d7b078d029d3fb3a85bf7bc1925"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1cb5d7b078d029d3fb3a85bf7bc1925">&#9670;&nbsp;</a></span>EncryptAuthenticate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; byte &gt; DUKPTClient::EncryptAuthenticate </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>Message</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>AdditionalData</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt and authenticate a PIN message. </p>
<p>The PIN is first encrypted, then the cipher-text is used to update a keyed HMAC(SHA2256) function. An optional data can be added to the MAC update, such as the IP address of the client. The authentication tag is appended to the encrypted PIN and returned by the function.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Message</td><td>The PIN message to encrypt</td></tr>
    <tr><td class="paramname">AdditionalData</td><td>The optional additional data used in authentication</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The encrypted message and appended authentication code</dd></dl>

</div>
</div>
<a id="a69f763e256f74571574230b63f07154b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69f763e256f74571574230b63f07154b">&#9670;&nbsp;</a></span>GenerateWorkingKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; byte &gt; DUKPTClient::GenerateWorkingKeys </td>
          <td>(</td>
          <td class="paramtype">DukptKeyUsage&#160;</td>
          <td class="paramname"><em>WorkingKeyUsage</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DukptKeyType&#160;</td>
          <td class="paramname"><em>WorkingKeyType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>B.6.3 The GenerateWorkingKeys function generates a working key for the current transaction </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">WorkingKeyUsage</td><td>The derivation key usage</td></tr>
    <tr><td class="paramname">WorkingKeyType</td><td>The cipher key type</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="a0efdad923f944a7f59bd1d9332fc8232"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0efdad923f944a7f59bd1d9332fc8232">&#9670;&nbsp;</a></span>LoadInitialKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DUKPTClient::LoadInitialKey </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>InitialKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DukptKeyType&#160;</td>
          <td class="paramname"><em>DeriveKeyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>InitialKeyId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>B.6.3 Processing Routines; Load an initial key for computing terminal transaction keys in sequence </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">InitialKey</td><td>The base derivation key</td></tr>
    <tr><td class="paramname">DeriveKeyType</td><td>The cipher key type</td></tr>
    <tr><td class="paramname">InitialKeyId</td><td>The initial key id</td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a id="aaca4512f7b2ebedfe3d385d78edaac77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaca4512f7b2ebedfe3d385d78edaac77">&#9670;&nbsp;</a></span>TransactionCounter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint DUKPTClient::TransactionCounter </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The current transaction key register </p>

</div>
</div>
<a id="ab84122de63b8771a05bed555ccac2c8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab84122de63b8771a05bed555ccac2c8c">&#9670;&nbsp;</a></span>UpdateInitialKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool DUKPTClient::UpdateInitialKey </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>EncryptedInitialKey</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">DukptKeyType&#160;</td>
          <td class="paramname"><em>InitialKeyType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; byte &gt; &amp;&#160;</td>
          <td class="paramname"><em>NewDeviceId</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>B.6.3 Update Initial Key; Load a new terminal initial key under a pre-existing terminal initial key </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EncryptedInitialKey</td><td>The encrypted initial key key</td></tr>
    <tr><td class="paramname">InitialKeyType</td><td>The cipher key type</td></tr>
    <tr><td class="paramname">NewDeviceId</td><td>The new device id</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns true if initial key loaded successfully</dd></dl>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>C:/Users/stepp/Documents/Develop/Github/CEX++/CEX/<a class="el" href="_d_u_k_p_t_client_8h_source.html">DUKPTClient.h</a></li>
<li>C:/Users/stepp/Documents/Develop/Github/CEX++/CEX/DUKPTClient.cpp</li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.18
</small></address>
</body>
</html>
